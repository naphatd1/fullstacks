<!DOCTYPE html>
<html>
<head>
    <title>Test Password Validation</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        .test-case { margin: 15px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .valid { background: #d4edda; border-color: #c3e6cb; }
        .invalid { background: #f8d7da; border-color: #f5c6cb; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .requirements { background: #e2e3e5; padding: 10px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Test Password Validation</h1>
        
        <div class="requirements">
            <h3>Password Requirements:</h3>
            <ul>
                <li>‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</li>
                <li>‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å (a-z)</li>
                <li>‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà (A-Z)</li>
                <li>‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (0-9)</li>
                <li>‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏© (@$!%*?&)</li>
            </ul>
        </div>
        
        <div class="form-group">
            <label>Test Password:</label>
            <input type="text" id="passwordInput" placeholder="Enter password to test">
            <button onclick="testPassword()">Test Password</button>
            <div id="testResult"></div>
        </div>
        
        <h3>Pre-defined Test Cases:</h3>
        
        <div class="test-case invalid">
            <strong>‚ùå "123456" - Too short, missing requirements</strong>
            <button onclick="testSpecificPassword('123456')">Test</button>
            <div id="result-123456"></div>
        </div>
        
        <div class="test-case invalid">
            <strong>‚ùå "password" - Missing uppercase, number, special char</strong>
            <button onclick="testSpecificPassword('password')">Test</button>
            <div id="result-password"></div>
        </div>
        
        <div class="test-case invalid">
            <strong>‚ùå "Password123" - Missing special character</strong>
            <button onclick="testSpecificPassword('Password123')">Test</button>
            <div id="result-Password123"></div>
        </div>
        
        <div class="test-case valid">
            <strong>‚úÖ "Password123!" - Valid (all requirements met)</strong>
            <button onclick="testSpecificPassword('Password123!')">Test</button>
            <div id="result-Password123!"></div>
        </div>
        
        <div class="test-case valid">
            <strong>‚úÖ "Test123@" - Valid (all requirements met)</strong>
            <button onclick="testSpecificPassword('Test123@')">Test</button>
            <div id="result-Test123@"></div>
        </div>
        
        <div class="test-case valid">
            <strong>‚úÖ "MyPass123$" - Valid (all requirements met)</strong>
            <button onclick="testSpecificPassword('MyPass123$')">Test</button>
            <div id="result-MyPass123$"></div>
        </div>
        
        <h3>Register Test:</h3>
        <div class="form-group">
            <label>Name:</label>
            <input type="text" id="testName" value="Test User">
        </div>
        <div class="form-group">
            <label>Email:</label>
            <input type="email" id="testEmail" value="">
        </div>
        <div class="form-group">
            <label>Password:</label>
            <input type="password" id="testPassword" value="Test123@">
        </div>
        <button onclick="testRegister()">Test Register with Valid Password</button>
        <div id="registerResult"></div>
    </div>

    <script>
        const API_URL = 'http://localhost:4000/api';
        
        // Generate unique email
        document.getElementById('testEmail').value = `test${Date.now()}@example.com`;
        
        function validatePassword(password) {
            const result = {
                isValid: true,
                errors: [],
                checks: {
                    length: password.length >= 8,
                    lowercase: /[a-z]/.test(password),
                    uppercase: /[A-Z]/.test(password),
                    number: /\d/.test(password),
                    special: /[@$!%*?&]/.test(password)
                }
            };
            
            if (!result.checks.length) {
                result.errors.push('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
                result.isValid = false;
            }
            
            if (!result.checks.lowercase) {
                result.errors.push('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å (a-z)');
                result.isValid = false;
            }
            
            if (!result.checks.uppercase) {
                result.errors.push('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà (A-Z)');
                result.isValid = false;
            }
            
            if (!result.checks.number) {
                result.errors.push('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (0-9)');
                result.isValid = false;
            }
            
            if (!result.checks.special) {
                result.errors.push('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏© (@$!%*?&)');
                result.isValid = false;
            }
            
            return result;
        }
        
        function showResult(elementId, content, type = 'info') {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `<div class="${type}">${content}</div>`;
            }
        }
        
        function testPassword() {
            const password = document.getElementById('passwordInput').value;
            const result = validatePassword(password);
            
            const checksHtml = Object.entries(result.checks)
                .map(([key, value]) => `<li>${value ? '‚úÖ' : '‚ùå'} ${key}: ${value}</li>`)
                .join('');
            
            const content = `
                <h4>${result.isValid ? '‚úÖ Valid Password' : '‚ùå Invalid Password'}</h4>
                <p><strong>Password:</strong> "${password}"</p>
                <p><strong>Length:</strong> ${password.length} characters</p>
                <ul>${checksHtml}</ul>
                ${result.errors.length > 0 ? `<p><strong>Errors:</strong></p><ul>${result.errors.map(e => `<li>${e}</li>`).join('')}</ul>` : ''}
            `;
            
            showResult('testResult', content, result.isValid ? 'success' : 'error');
        }
        
        function testSpecificPassword(password) {
            const result = validatePassword(password);
            const elementId = `result-${password.replace(/[^a-zA-Z0-9]/g, '')}`;
            
            const content = `
                <p><strong>Result:</strong> ${result.isValid ? '‚úÖ Valid' : '‚ùå Invalid'}</p>
                ${result.errors.length > 0 ? `<p><strong>Issues:</strong> ${result.errors.join(', ')}</p>` : ''}
            `;
            
            showResult(elementId, content, result.isValid ? 'success' : 'error');
        }
        
        async function testRegister() {
            const formData = {
                name: document.getElementById('testName').value,
                email: document.getElementById('testEmail').value,
                password: document.getElementById('testPassword').value
            };
            
            // First validate password locally
            const passwordResult = validatePassword(formData.password);
            
            if (!passwordResult.isValid) {
                showResult('registerResult', `
                    <h4>‚ùå Password Validation Failed</h4>
                    <p><strong>Errors:</strong></p>
                    <ul>${passwordResult.errors.map(e => `<li>${e}</li>`).join('')}</ul>
                    <p>Please fix the password before testing register.</p>
                `, 'error');
                return;
            }
            
            showResult('registerResult', 'Testing register with valid password...', 'info');
            
            try {
                const response = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showResult('registerResult', `
                        <h4>‚úÖ Register Success!</h4>
                        <p><strong>User:</strong> ${data.user.email}</p>
                        <p><strong>Name:</strong> ${data.user.name}</p>
                        <p><strong>Role:</strong> ${data.user.role}</p>
                        <p>Password validation and registration both successful!</p>
                    `, 'success');
                } else {
                    const errorText = await response.text();
                    showResult('registerResult', `
                        <h4>‚ùå Register Failed</h4>
                        <p><strong>Status:</strong> ${response.status}</p>
                        <p><strong>Error:</strong> ${errorText}</p>
                    `, 'error');
                }
                
            } catch (error) {
                showResult('registerResult', `
                    <h4>‚ùå Network Error</h4>
                    <p><strong>Error:</strong> ${error.message}</p>
                `, 'error');
            }
        }
        
        // Auto-test some passwords on load
        window.addEventListener('load', () => {
            testSpecificPassword('123456');
            testSpecificPassword('password');
            testSpecificPassword('Password123');
            testSpecificPassword('Password123!');
            testSpecificPassword('Test123@');
            testSpecificPassword('MyPass123$');
        });
    </script>
</body>
</html>